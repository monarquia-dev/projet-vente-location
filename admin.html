<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administration - GR√ÇCE AUTO SERVICE-CI-BKT</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a3a8f;
            --secondary-color: #2a5caa;
            --accent-color: #ffcc00;
            --accent-dark: #e6b800;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --light-color: #f5f5f5;
            --dark-color: #0a0f2b;
            --darker-color: #050a1a;
            --card-bg: rgba(255, 255, 255, 0.05);
            --card-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #b3b3cc;
            --sidebar-width: 280px;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --glow: 0 0 15px rgba(255, 204, 0, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, var(--darker-color), var(--dark-color));
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .admin-container {
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar Styles */
        .admin-sidebar {
            width: var(--sidebar-width);
            background: rgba(10, 15, 43, 0.95);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s;
            z-index: 1000;
            border-right: 1px solid var(--card-border);
            box-shadow: var(--shadow);
        }
        
        .admin-logo {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid var(--card-border);
            margin-bottom: 20px;
        }
        
        .admin-logo h2 {
            font-size: 1.2rem;
            margin-bottom: 5px;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .admin-logo p {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }
        
        .admin-menu {
            list-style: none;
            padding: 0 15px;
            margin: 0;
        }
        
        .admin-menu li {
            margin-bottom: 8px;
        }
        
        .admin-menu a {
            padding: 12px 15px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            border-radius: 8px;
            color: var(--text-secondary);
            text-decoration: none;
        }
        
        .admin-menu a:hover, .admin-menu a.active {
            background: rgba(255, 204, 0, 0.1);
            color: var(--accent-color);
            box-shadow: var(--glow);
        }
        
        .admin-menu i {
            margin-right: 10px;
            width: 20px;
            text-align: center;
            font-size: 1.1rem;
        }
        
        /* Main Content Styles */
        .admin-main {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 20px;
            transition: all 0.3s;
        }
        
        .admin-header {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
        }
        
        .admin-title h1 {
            font-size: 1.8rem;
            font-weight: 600;
            background: linear-gradient(90deg, var(--accent-color), var(--primary-color));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 5px;
        }
        
        .admin-title p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        .admin-actions {
            display: flex;
            gap: 10px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-color), var(--accent-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-weight: bold;
        }
        
        /* Tab Content Styles */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Stats Grid */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            border-color: var(--accent-color);
            box-shadow: var(--glow);
        }
        
        .stat-card i {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--accent-color);
        }
        
        .stat-card h3 {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--accent-color);
        }
        
        .stat-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }
        
        /* Table Container */
        .admin-table-container {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .table-header {
            padding: 20px;
            border-bottom: 1px solid var(--card-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .table-header h3 {
            color: var(--text-primary);
            font-size: 1.4rem;
            margin: 0;
        }
        
        .search-box {
            display: flex;
            gap: 10px;
        }
        
        .search-input {
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 4px;
            color: var(--text-primary);
            width: 250px;
        }
        
        .search-input:focus {
            border-color: var(--accent-color);
            outline: none;
        }
        
        /* Table Styles */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--card-border);
        }
        
        td {
            padding: 15px;
            border-bottom: 1px solid var(--card-border);
            color: var(--text-secondary);
        }
        
        tr:hover {
            background: rgba(255, 255, 255, 0.02);
        }
        
        .item-image-cell {
            width: 60px;
        }
        
        .item-image-small {
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 4px;
        }
        
        /* Status Badges */
        .status-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        
        .status-available {
            background: rgba(40, 167, 69, 0.2);
            color: var(--success-color);
        }
        
        .status-sold, .status-rented {
            background: rgba(220, 53, 69, 0.2);
            color: var(--danger-color);
        }
        
        .status-maintenance {
            background: rgba(255, 193, 7, 0.2);
            color: var(--warning-color);
        }
        
        .item-type {
            display: inline-block;
            padding: 4px 8px;
            background: rgba(255, 204, 0, 0.1);
            color: var(--accent-color);
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .item-type.vehicule {
            background: rgba(39, 174, 96, 0.1);
            color: #27ae60;
        }
        
        .item-type.residence {
            background: rgba(230, 126, 34, 0.1);
            color: #e67e22;
        }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .btn-icon {
            width: 36px;
            height: 36px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-secondary);
            border: 1px solid var(--card-border);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-icon:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
        }
        
        .btn-icon.edit:hover {
            color: var(--accent-color);
            border-color: var(--accent-color);
        }
        
        .btn-icon.delete:hover {
            color: var(--danger-color);
            border-color: var(--danger-color);
        }
        
        .btn-icon.eye:hover {
            color: var(--success-color);
            border-color: var(--success-color);
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--card-border);
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            color: var(--text-secondary);
        }
        
        .tab.active {
            border-bottom-color: var(--accent-color);
            color: var(--accent-color);
            font-weight: 500;
        }
        
        /* Button Styles */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--accent-color), var(--accent-dark));
            color: #333;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--glow);
        }
        
        .btn-success {
            background: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            border: 1px solid var(--card-border);
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .btn-danger {
            background: var(--danger-color);
            color: white;
        }
        
        .btn-danger:hover {
            background: #c82333;
            transform: translateY(-2px);
        }
        
        .btn-info {
            background: var(--info-color);
            color: white;
        }
        
        .btn-info:hover {
            background: #138496;
            transform: translateY(-2px);
        }
        
        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            padding: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 4px;
            font-size: 1rem;
            transition: border 0.3s;
            color: var(--text-primary);
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: var(--accent-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(255, 204, 0, 0.2);
        }
        
        .form-group textarea {
            height: 100px;
            resize: vertical;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
            backdrop-filter: blur(10px);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid var(--card-border);
        }
        
        .modal-header h3 {
            color: var(--text-primary);
            font-size: 1.3rem;
        }
        
        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.3s;
        }
        
        .modal-close:hover {
            color: var(--text-primary);
        }
        
        .modal-body {
            padding: 25px;
        }
        
        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            padding: 20px 25px;
            border-top: 1px solid var(--card-border);
        }
        
        /* Status Select */
        .status-select {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--card-border);
            border-radius: 4px;
            padding: 6px 10px;
            color: var(--text-primary);
            cursor: pointer;
        }
        
        .status-select:focus {
            border-color: var(--accent-color);
            outline: none;
        }
        
        /* Sync Section */
        .sync-section {
            background: rgba(255, 204, 0, 0.05);
            border: 1px solid rgba(255, 204, 0, 0.2);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .sync-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .sync-info i {
            color: var(--accent-color);
        }
        
        .sync-actions {
            display: flex;
            gap: 10px;
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 3000;
            animation: slideIn 0.3s;
            display: none;
        }
        
        .notification.error {
            background: var(--danger-color);
        }
        
        .notification.warning {
            background: var(--warning-color);
        }
        
        .notification.info {
            background: var(--info-color);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .admin-sidebar {
                width: 70px;
                overflow: visible;
            }
            
            .admin-logo h2, .admin-logo p, .admin-menu span {
                display: none;
            }
            
            .admin-menu a {
                justify-content: center;
                padding: 15px;
            }
            
            .admin-menu i {
                margin-right: 0;
                font-size: 1.2rem;
            }
            
            .admin-main {
                margin-left: 70px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-cards {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .search-input {
                width: 150px;
            }
            
            .admin-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .admin-actions {
                width: 100%;
                justify-content: center;
            }
        }
        
        @media (max-width: 576px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
            
            .table-header {
                flex-direction: column;
                gap: 15px;
            }
            
            .search-box {
                width: 100%;
            }
            
            .search-input {
                width: 100%;
            }
            
            table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar Navigation -->
        <aside class="admin-sidebar">
            <div class="admin-logo">
                <h2>GR√ÇCE AUTO SERVICE</h2>
                <p>Administration Compl√®te</p>
            </div>
            <ul class="admin-menu">
                <li><a href="#" class="active" onclick="showTab('dashboard')"><i class="fas fa-tachometer-alt"></i> <span>Tableau de Bord</span></a></li>
                <li><a href="#" onclick="showTab('vehicules')"><i class="fas fa-car"></i> <span>V√©hicules</span></a></li>
                <li><a href="#" onclick="showTab('residences')"><i class="fas fa-home"></i> <span>R√©sidences</span></a></li>
                <li><a href="#" onclick="showTab('reservations')"><i class="fas fa-calendar-alt"></i> <span>R√©servations</span></a></li>
                <li><a href="#" onclick="showTab('settings')"><i class="fas fa-cog"></i> <span>Param√®tres</span></a></li>
                <li><a href="#" onclick="showTab('database')"><i class="fas fa-database"></i> <span>Base de Donn√©es</span></a></li>
                <li><a href="index.html" target="_blank"><i class="fas fa-eye"></i> <span>Voir le Site</span></a></li>
                <li><a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> <span>D√©connexion</span></a></li>
            </ul>
        </aside>

        <!-- Main Content Area -->
        <main class="admin-main">
            <!-- Tableau de Bord -->
            <div id="dashboard" class="tab-content active">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Tableau de Bord</h1>
                        <p>Bienvenue dans l'administration de GR√ÇCE AUTO SERVICE</p>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="showAddModal()">
                            <i class="fas fa-plus"></i> Ajouter un v√©hicule
                        </button>
                        <button class="btn btn-secondary" onclick="syncData()">
                            <i class="fas fa-sync"></i> Synchroniser
                        </button>
                    </div>
                </div>

                <!-- Statistiques -->
                <div class="stats-cards">
                    <div class="stat-card">
                        <i class="fas fa-car"></i>
                        <h3 id="stats-vehicules">0</h3>
                        <p>V√©hicules en vente</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-car-side"></i>
                        <h3 id="stats-locations">0</h3>
                        <p>V√©hicules en location</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-home"></i>
                        <h3 id="stats-residences">0</h3>
                        <p>R√©sidences</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-calendar-check"></i>
                        <h3 id="stats-reservations">0</h3>
                        <p>R√©servations</p>
                    </div>
                </div>

                <!-- Articles R√©cents -->
                <div class="admin-table-container">
                    <div class="table-header">
                        <h3>Articles R√©cents</h3>
                        <div class="search-box">
                            <input type="text" class="search-input" placeholder="Rechercher..." onkeyup="filterItems(this.value)">
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Titre</th>
                                <th>Type</th>
                                <th>Prix</th>
                                <th>Statut</th>
                                <th>Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="recent-items">
                            <!-- Les items r√©cents seront charg√©s ici -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- V√©hicules -->
            <div id="vehicules" class="tab-content">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Gestion des V√©hicules</h1>
                        <p>G√©rez tous vos v√©hicules en vente et location</p>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="showAddModal('vehicule')">
                            <i class="fas fa-plus"></i> Ajouter un v√©hicule
                        </button>
                    </div>
                </div>

                <div class="tabs">
                    <div class="tab active" onclick="showVehicleTab('vente')">Vente</div>
                    <div class="tab" onclick="showVehicleTab('location')">Location</div>
                </div>

                <div class="admin-table-container">
                    <div class="table-header">
                        <h3 id="vehicle-tab-title">V√©hicules en vente</h3>
                        <div class="search-box">
                            <input type="text" class="search-input" placeholder="Rechercher un v√©hicule..." onkeyup="filterVehicles(this.value)">
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Titre</th>
                                <th>Type</th>
                                <th>Prix</th>
                                <th>Disponibilit√©</th>
                                <th>Caract√©ristiques</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="vehicles-table">
                            <!-- Les v√©hicules seront charg√©s ici -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- R√©sidences -->
            <div id="residences" class="tab-content">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Gestion des R√©sidences</h1>
                        <p>G√©rez toutes vos propri√©t√©s immobili√®res</p>
                    </div>
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="showAddModal('residence')">
                            <i class="fas fa-plus"></i> Ajouter une r√©sidence
                        </button>
                    </div>
                </div>

                <div class="admin-table-container">
                    <div class="table-header">
                        <h3>Liste des R√©sidences</h3>
                        <div class="search-box">
                            <input type="text" class="search-input" placeholder="Rechercher une r√©sidence..." onkeyup="filterResidences(this.value)">
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Image</th>
                                <th>Titre</th>
                                <th>Localisation</th>
                                <th>Prix</th>
                                <th>Pi√®ces</th>
                                <th>Disponibilit√©</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="residences-table">
                            <!-- Les r√©sidences seront charg√©es ici -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- R√©servations -->
            <div id="reservations" class="tab-content">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Gestion des R√©servations</h1>
                        <p>Suivez toutes les demandes de r√©servation</p>
                    </div>
                </div>

                <div class="admin-table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Client</th>
                                <th>Article</th>
                                <th>Date</th>
                                <th>Statut</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reservations-table">
                            <!-- Les r√©servations seront charg√©es ici -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Param√®tres -->
            <div id="settings" class="tab-content">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Param√®tres du Site</h1>
                        <p>Configurez les informations de votre entreprise</p>
                    </div>
                </div>

                <div class="admin-table-container">
                    <div class="table-header">
                        <h3>Informations de Contact</h3>
                    </div>
                    <div class="modal-body">
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label>Nom de l'entreprise</label>
                                <input type="text" id="setting-name" placeholder="GR√ÇCE AUTO SERVICE-CI-BKT">
                            </div>
                            <div class="form-group full-width">
                                <label>Description</label>
                                <input type="text" id="setting-description" placeholder="Vente ‚Ä¢ Location ‚Ä¢ Assurance">
                            </div>
                            <div class="form-group">
                                <label>T√©l√©phone principal</label>
                                <input type="text" id="setting-phone" placeholder="+225 0748735115">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="setting-email" placeholder="graceautoservice88@gmail.com">
                            </div>
                            <div class="form-group">
                                <label>T√©l√©phone secondaire 1</label>
                                <input type="text" id="setting-phone2" placeholder="+225 0141941694">
                            </div>
                            <div class="form-group">
                                <label>T√©l√©phone secondaire 2</label>
                                <input type="text" id="setting-phone3" placeholder="+225 0544604246">
                            </div>
                            <div class="form-group">
                                <label>Horaires semaine</label>
                                <input type="text" id="setting-hours-week" placeholder="Lun-Ven: 8h-18h">
                            </div>
                            <div class="form-group">
                                <label>Horaires samedi</label>
                                <input type="text" id="setting-hours-sat" placeholder="Samedi: 8h-13h">
                            </div>
                            <div class="form-group">
                                <label>Horaires dimanche</label>
                                <input type="text" id="setting-hours-sun" placeholder="Dimanche: Ferm√©">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" onclick="saveSettings()">Enregistrer les param√®tres</button>
                    </div>
                </div>
            </div>

            <!-- Base de donn√©es -->
            <div id="database" class="tab-content">
                <div class="admin-header">
                    <div class="admin-title">
                        <h1>Base de Donn√©es</h1>
                        <p>G√©rez et sauvegardez vos donn√©es</p>
                    </div>
                </div>

                <div class="sync-section">
                    <div class="sync-info">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>Derni√®re synchronisation:</strong>
                            <span id="last-sync">Chargement...</span>
                        </div>
                    </div>
                    
                    <div class="sync-actions">
                        <button class="btn btn-primary" onclick="syncData()">
                            <i class="fas fa-sync"></i> Synchroniser maintenant
                        </button>
                        <button class="btn btn-secondary" onclick="exportData()">
                            <i class="fas fa-download"></i> Exporter les donn√©es
                        </button>
                        <button class="btn btn-danger" onclick="showBackupModal()">
                            <i class="fas fa-save"></i> Sauvegarder
                        </button>
                    </div>
                </div>

                <div class="admin-table-container" style="margin-top: 20px;">
                    <div class="table-header">
                        <h3>Statistiques de la base</h3>
                    </div>
                    <div class="modal-body">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Total v√©hicules</label>
                                <input type="text" id="db-vehicules" readonly>
                            </div>
                            <div class="form-group">
                                <label>Total r√©sidences</label>
                                <input type="text" id="db-residences" readonly>
                            </div>
                            <div class="form-group">
                                <label>Total r√©servations</label>
                                <input type="text" id="db-reservations" readonly>
                            </div>
                            <div class="form-group">
                                <label>Taille de la base</label>
                                <input type="text" id="db-size" readonly>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modal Ajout/Modification -->
    <div id="item-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Ajouter un nouvel article</h3>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="item-type">Type d'article *</label>
                        <select id="item-type" onchange="toggleItemFields()">
                            <option value="">S√©lectionner...</option>
                            <option value="vehicule_vente">V√©hicule en vente</option>
                            <option value="vehicule_location">V√©hicule en location</option>
                            <option value="residence">R√©sidence</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="item-title">Titre *</label>
                        <input type="text" id="item-title" placeholder="Toyota RAV4 2023">
                    </div>
                    <div class="form-group">
                        <label for="item-price">Prix (FCFA) *</label>
                        <input type="number" id="item-price" placeholder="80000000">
                    </div>
                    <div class="form-group">
                        <label for="item-image">URL de l'image</label>
                        <input type="text" id="item-image" placeholder="https://example.com/image.jpg">
                    </div>
                    <div class="form-group full-width">
                        <label for="item-description">Description</label>
                        <textarea id="item-description" placeholder="D√©crivez l'article..."></textarea>
                    </div>
                    
                    <!-- Champs sp√©cifiques v√©hicules -->
                    <div id="vehicle-fields" style="display: none;" class="full-width">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="vehicle-type">Type de v√©hicule</label>
                                <select id="vehicle-type">
                                    <option value="SUV">SUV</option>
                                    <option value="Berline">Berline</option>
                                    <option value="Compacte">Compacte</option>
                                    <option value="Utilitaire">Utilitaire</option>
                                    <option value="4x4">4x4</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="vehicle-status">Statut</label>
                                <select id="vehicle-status">
                                    <option value="available">Disponible</option>
                                    <option value="sold">Vendu</option>
                                    <option value="rented">Lou√©</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label>Caract√©ristiques (s√©par√©es par des virgules)</label>
                            <input type="text" id="vehicle-features" placeholder="4x4, Automatique, Climatisation, Camera de recul">
                        </div>
                    </div>
                    
                    <!-- Champs sp√©cifiques r√©sidences -->
                    <div id="residence-fields" style="display: none;" class="full-width">
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="residence-location">Localisation</label>
                                <input type="text" id="residence-location" placeholder="Paris 15√®me">
                            </div>
                            <div class="form-group">
                                <label for="residence-rooms">Nombre de pi√®ces</label>
                                <input type="number" id="residence-rooms" placeholder="3">
                            </div>
                            <div class="form-group">
                                <label for="residence-status">Statut</label>
                                <select id="residence-status">
                                    <option value="available">Disponible</option>
                                    <option value="rented">Lou√©</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group full-width">
                            <label>Caract√©ristiques (s√©par√©es par des virgules)</label>
                            <input type="text" id="residence-features" placeholder="80m¬≤, 3 chambres, Balcon, Ascenseur">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Annuler</button>
                <button class="btn btn-primary" onclick="saveItem()">Enregistrer</button>
            </div>
        </div>
    </div>

    <!-- Modal Confirmation -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>Confirmation</h3>
                <button class="modal-close" onclick="closeConfirmModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirm-message">√ätes-vous s√ªr de vouloir supprimer cet √©l√©ment ?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeConfirmModal()">Annuler</button>
                <button class="btn btn-danger" onclick="confirmAction()">Confirmer</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i> <span id="notificationText">Action effectu√©e avec succ√®s</span>
    </div>

    <script>
        // ========== BASE DE DONN√âES JSON ==========
        const DB_KEY = 'grace_auto_database';
        
        // Structure de la base de donn√©es par d√©faut
        const DEFAULT_DATABASE = {
            meta: {
                version: '1.0.0',
                created_at: new Date().toISOString(),
                last_updated: new Date().toISOString(),
                total_vehicles: 0,
                total_residences: 0,
                total_reservations: 0
            },
            vehicules: [],
            residences: [],
            reservations: [],
            settings: {
                name: "GR√ÇCE AUTO SERVICE-CI-BKT",
                description: "Vente et location de v√©hicules, r√©sidences meubl√©es et assurance voyage en C√¥te d'Ivoire. Service de qualit√© et professionnel.",
                contactEmail: "graceautoservice88@gmail.com",
                contactPhone: "+225 0748735115",
                otherPhones: ["+225 0141941694", "+225 0544604246"],
                businessHours: {
                    weekday: "Lun-Ven: 8h-18h",
                    saturday: "Samedi: 8h-13h",
                    sunday: "Dimanche: Ferm√©"
                }
            }
        };

        // Base de donn√©es actuelle
        let currentData = { ...DEFAULT_DATABASE };

        // Variables globales
        let currentTab = 'dashboard';
        let currentVehicleTab = 'vente';
        let editingItemId = null;
        let pendingAction = null;

        // ========== INITIALISATION ==========
        function initDatabase() {
            console.log('üîß Initialisation de la base de donn√©es...');
            
            // Charger depuis localStorage ou utiliser la base par d√©faut
            const stored = localStorage.getItem(DB_KEY);
            if (stored) {
                try {
                    currentData = JSON.parse(stored);
                    console.log('üìÅ Base de donn√©es charg√©e depuis localStorage');
                } catch (error) {
                    console.error('‚ùå Erreur de chargement, utilisation de la base par d√©faut:', error);
                    currentData = { ...DEFAULT_DATABASE };
                    saveDatabase();
                }
            } else {
                console.log('üÜï Base de donn√©es par d√©faut cr√©√©e');
                saveDatabase();
            }
            
            loadData();
            showNotification('Syst√®me d\'administration charg√© avec succ√®s', 'success');
        }

        function saveDatabase() {
            try {
                // Mettre √† jour les m√©tadonn√©es
                currentData.meta.last_updated = new Date().toISOString();
                currentData.meta.total_vehicles = currentData.vehicules?.length || 0;
                currentData.meta.total_residences = currentData.residences?.length || 0;
                currentData.meta.total_reservations = currentData.reservations?.length || 0;
                
                // Sauvegarder dans localStorage
                localStorage.setItem(DB_KEY, JSON.stringify(currentData));
                
                console.log('üíæ Base de donn√©es sauvegard√©e');
                return true;
            } catch (e) {
                console.error('‚ùå Erreur de sauvegarde:', e);
                showNotification('Erreur de sauvegarde', 'error');
                return false;
            }
        }

        // ========== FONCTIONS UTILITAIRES ==========
        function formatPrice(price) {
            if (!price) return '0 FCFA';
            return new Intl.NumberFormat('fr-FR').format(price) + ' FCFA';
        }

        function getStatusText(item) {
            if (!item.disponible) {
                return item.categorie === 'vente' ? 'Vendu' : 'Lou√©';
            }
            return 'Disponible';
        }

        function getStatusClass(item) {
            if (!item.disponible) {
                if (item.categorie === 'vente') return 'status-sold';
                return 'status-rented';
            }
            return 'status-available';
        }

        function formatDate(dateString) {
            if (!dateString) return 'N/A';
            return new Date(dateString).toLocaleDateString('fr-FR');
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            const icon = notification.querySelector('i');
            
            if (!notification || !notificationText) return;
            
            notificationText.textContent = message;
            notification.className = 'notification';
            
            switch(type) {
                case 'error':
                    notification.classList.add('error');
                    icon.className = 'fas fa-exclamation-circle';
                    break;
                case 'warning':
                    notification.classList.add('warning');
                    icon.className = 'fas fa-exclamation-triangle';
                    break;
                case 'info':
                    notification.classList.add('info');
                    icon.className = 'fas fa-info-circle';
                    break;
                default:
                    icon.className = 'fas fa-check-circle';
            }
            
            notification.style.display = 'flex';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // ========== FONCTIONS D'AFFICHAGE ==========
        function loadData() {
            updateDashboard();
            updateAllTables();
        }

        function updateDashboard() {
            if (!currentData) return;

            // Calculer les statistiques
            const vehiculesVente = (currentData.vehicules || []).filter(v => v.categorie === 'vente').length;
            const vehiculesLocation = (currentData.vehicules || []).filter(v => v.categorie === 'location').length;
            const totalResidences = (currentData.residences || []).length;
            const totalReservations = (currentData.reservations || []).length;

            document.getElementById('stats-vehicules').textContent = vehiculesVente;
            document.getElementById('stats-locations').textContent = vehiculesLocation;
            document.getElementById('stats-residences').textContent = totalResidences;
            document.getElementById('stats-reservations').textContent = totalReservations;

            updateRecentItems();
            updateDatabaseStats();
        }

        function updateRecentItems() {
            const container = document.getElementById('recent-items');
            const allItems = [
                ...(currentData.vehicules || []).map(v => ({ ...v, type: 'vehicule' })),
                ...(currentData.residences || []).map(r => ({ ...r, type: 'residence' }))
            ];
            
            // Trier par date de cr√©ation (les plus r√©cents d'abord)
            const recentItems = allItems
                .sort((a, b) => new Date(b.createdAt || 0) - new Date(a.createdAt || 0))
                .slice(0, 10);

            container.innerHTML = recentItems.map(item => `
                <tr>
                    <td class="item-image-cell">
                        <img src="${item.image || 'https://via.placeholder.com/50x50?text=No+Image'}" 
                             alt="${item.titre}" 
                             class="item-image-small"
                             onerror="this.src='https://via.placeholder.com/50x50?text=Error'">
                    </td>
                    <td>${item.titre}</td>
                    <td>
                        <span class="item-type ${item.type}">
                            ${item.type === 'vehicule' ? 'V√©hicule' : 'R√©sidence'}
                        </span>
                    </td>
                    <td>${formatPrice(item.prix)}${item.categorie === 'location' ? '/mois' : ''}</td>
                    <td>
                        <span class="status-badge ${getStatusClass(item)}">
                            ${getStatusText(item)}
                        </span>
                    </td>
                    <td>${formatDate(item.createdAt)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon edit" onclick="editItem(${item.id}, '${item.type}')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon delete" onclick="deleteItem(${item.id}, '${item.type}')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function updateVehiclesTable() {
            const container = document.getElementById('vehicles-table');
            let vehicles = currentVehicleTab === 'vente' 
                ? (currentData.vehicules || []).filter(v => v.categorie === 'vente')
                : (currentData.vehicules || []).filter(v => v.categorie === 'location');

            container.innerHTML = vehicles.map(vehicle => `
                <tr>
                    <td class="item-image-cell">
                        <img src="${vehicle.image || 'https://via.placeholder.com/50x50?text=No+Image'}" 
                             alt="${vehicle.titre}" 
                             class="item-image-small"
                             onerror="this.src='https://via.placeholder.com/50x50?text=Error'">
                    </td>
                    <td>${vehicle.titre}</td>
                    <td>${vehicle.type || 'Non sp√©cifi√©'}</td>
                    <td>${formatPrice(vehicle.prix)}${currentVehicleTab === 'location' ? '/mois' : ''}</td>
                    <td>
                        <select class="status-select" data-id="${vehicle.id}" onchange="updateVehicleStatus(${vehicle.id}, this.value)">
                            <option value="available" ${vehicle.disponible ? 'selected' : ''}>Disponible</option>
                            <option value="sold" ${!vehicle.disponible && vehicle.categorie === 'vente' ? 'selected' : ''}>Vendu</option>
                            <option value="rented" ${!vehicle.disponible && vehicle.categorie === 'location' ? 'selected' : ''}>Lou√©</option>
                        </select>
                    </td>
                    <td>
                        <small>${(vehicle.caracteristiques || []).slice(0, 2).join(', ')}</small>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon edit" onclick="editItem(${vehicle.id}, 'vehicule')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon delete" onclick="deleteItem(${vehicle.id}, 'vehicule')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function updateResidencesTable() {
            const container = document.getElementById('residences-table');
            const residences = currentData.residences || [];

            container.innerHTML = residences.map(residence => `
                <tr>
                    <td class="item-image-cell">
                        <img src="${residence.image || 'https://via.placeholder.com/50x50?text=No+Image'}" 
                             alt="${residence.titre}" 
                             class="item-image-small"
                             onerror="this.src='https://via.placeholder.com/50x50?text=Error'">
                    </td>
                    <td>${residence.titre}</td>
                    <td>${residence.localisation || 'Non sp√©cifi√©e'}</td>
                    <td>${formatPrice(residence.prix)}/mois</td>
                    <td>${residence.rooms || 'N/A'}</td>
                    <td>
                        <select class="status-select" data-id="${residence.id}" onchange="updateResidenceStatus(${residence.id}, this.value)">
                            <option value="available" ${residence.disponible ? 'selected' : ''}>Disponible</option>
                            <option value="rented" ${!residence.disponible ? 'selected' : ''}>Lou√©</option>
                        </select>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon edit" onclick="editItem(${residence.id}, 'residence')">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon delete" onclick="deleteItem(${residence.id}, 'residence')">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function updateReservationsTable() {
            const container = document.getElementById('reservations-table');
            const reservations = currentData.reservations || [];

            if (reservations.length === 0) {
                container.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px;">
                            <i class="fas fa-calendar-times" style="font-size: 3rem; color: var(--text-secondary); margin-bottom: 10px;"></i>
                            <p style="color: var(--text-secondary);">Aucune r√©servation pour le moment</p>
                        </td>
                    </tr>
                `;
                return;
            }

            container.innerHTML = reservations.map(reservation => `
                <tr>
                    <td>#${reservation.id}</td>
                    <td>${reservation.nom}<br><small>${reservation.email}</small></td>
                    <td>${reservation.itemTitre || 'Article'}</td>
                    <td>${formatDate(reservation.date)}</td>
                    <td>
                        <select class="status-select" data-id="${reservation.id}" onchange="updateReservationStatus(${reservation.id}, this.value)">
                            <option value="pending" ${reservation.statut === 'pending' ? 'selected' : ''}>En attente</option>
                            <option value="confirmed" ${reservation.statut === 'confirmed' ? 'selected' : ''}>Confirm√©e</option>
                            <option value="cancelled" ${reservation.statut === 'cancelled' ? 'selected' : ''}>Annul√©e</option>
                        </select>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon delete" onclick="deleteReservation(${reservation.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function updateDatabaseStats() {
            if (!currentData) return;

            document.getElementById('db-vehicules').value = currentData.vehicules?.length || 0;
            document.getElementById('db-residences').value = currentData.residences?.length || 0;
            document.getElementById('db-reservations').value = currentData.reservations?.length || 0;
            
            const dataSize = JSON.stringify(currentData).length;
            document.getElementById('db-size').value = `${(dataSize / 1024).toFixed(2)} KB`;
            
            document.getElementById('last-sync').textContent = 
                new Date(currentData.meta?.last_updated || Date.now()).toLocaleString('fr-FR');
            
            // Charger les param√®tres
            const settings = currentData.settings || {};
            document.getElementById('setting-name').value = settings.name || '';
            document.getElementById('setting-description').value = settings.description || '';
            document.getElementById('setting-phone').value = settings.contactPhone || '';
            document.getElementById('setting-email').value = settings.contactEmail || '';
            document.getElementById('setting-phone2').value = (settings.otherPhones || [])[0] || '';
            document.getElementById('setting-phone3').value = (settings.otherPhones || [])[1] || '';
            document.getElementById('setting-hours-week').value = settings.businessHours?.weekday || '';
            document.getElementById('setting-hours-sat').value = settings.businessHours?.saturday || '';
            document.getElementById('setting-hours-sun').value = settings.businessHours?.sunday || '';
        }

        // ========== GESTION DES ONGLETS ==========
        function showTab(tabName) {
            // Masquer tous les onglets
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // D√©sactiver tous les liens du menu
            document.querySelectorAll('.admin-menu a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Activer l'onglet s√©lectionn√©
            document.getElementById(tabName).classList.add('active');
            
            // Activer le lien du menu correspondant
            const menuItem = document.querySelector(`.admin-menu a[onclick*="${tabName}"]`);
            if (menuItem) {
                menuItem.classList.add('active');
            }
            
            currentTab = tabName;
        }

        function showVehicleTab(tab) {
            currentVehicleTab = tab;
            
            // Mettre √† jour les onglets
            document.querySelectorAll('#vehicules .tab').forEach(t => {
                t.classList.remove('active');
            });
            
            const activeTab = document.querySelector(`#vehicules .tab[onclick*="${tab}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }
            
            // Mettre √† jour le titre
            document.getElementById('vehicle-tab-title').textContent = 
                tab === 'vente' ? 'V√©hicules en vente' : 'V√©hicules en location';
            
            updateVehiclesTable();
        }

        // ========== GESTION DES MODALS ==========
        function showAddModal(itemType = null) {
            editingItemId = null;
            const modal = document.getElementById('item-modal');
            const title = document.getElementById('modal-title');
            
            // R√©initialiser le formulaire
            document.getElementById('item-type').value = '';
            document.getElementById('item-title').value = '';
            document.getElementById('item-price').value = '';
            document.getElementById('item-image').value = '';
            document.getElementById('item-description').value = '';
            document.getElementById('vehicle-type').value = 'SUV';
            document.getElementById('vehicle-status').value = 'available';
            document.getElementById('vehicle-features').value = '';
            document.getElementById('residence-location').value = '';
            document.getElementById('residence-rooms').value = '1';
            document.getElementById('residence-status').value = 'available';
            document.getElementById('residence-features').value = '';
            
            toggleItemFields();
            
            if (itemType) {
                const typeSelect = document.getElementById('item-type');
                if (itemType === 'vehicule') {
                    typeSelect.value = 'vehicule_vente';
                } else if (itemType === 'residence') {
                    typeSelect.value = 'residence';
                }
                toggleItemFields();
            }
            
            title.textContent = 'Ajouter un nouvel article';
            modal.classList.add('active');
        }

        function editItem(id, type) {
            let item;
            if (type === 'vehicule') {
                item = (currentData.vehicules || []).find(v => v.id === id);
            } else {
                item = (currentData.residences || []).find(r => r.id === id);
            }
            
            if (!item) {
                showNotification('Article non trouv√©', 'error');
                return;
            }

            editingItemId = id;
            const modal = document.getElementById('item-modal');
            const title = document.getElementById('modal-title');
            
            // Remplir le formulaire
            const isVehicle = type === 'vehicule';
            const typeSelect = document.getElementById('item-type');
            
            if (isVehicle) {
                typeSelect.value = item.categorie === 'location' ? 'vehicule_location' : 'vehicule_vente';
            } else {
                typeSelect.value = 'residence';
            }
            
            toggleItemFields();
            
            document.getElementById('item-title').value = item.titre || '';
            document.getElementById('item-price').value = item.prix || '';
            document.getElementById('item-image').value = item.image || '';
            document.getElementById('item-description').value = item.description || '';
            
            if (isVehicle) {
                document.getElementById('vehicle-type').value = item.type || 'SUV';
                document.getElementById('vehicle-status').value = 
                    !item.disponible ? (item.categorie === 'vente' ? 'sold' : 'rented') : 'available';
                document.getElementById('vehicle-features').value = 
                    (item.caracteristiques || []).join(', ');
            } else {
                document.getElementById('residence-location').value = item.localisation || '';
                document.getElementById('residence-rooms').value = item.rooms || '';
                document.getElementById('residence-status').value = 
                    !item.disponible ? 'rented' : 'available';
                document.getElementById('residence-features').value = 
                    (item.caracteristiques || []).join(', ');
            }
            
            title.textContent = 'Modifier l\'article';
            modal.classList.add('active');
        }

        function toggleItemFields() {
            const type = document.getElementById('item-type').value;
            const vehicleFields = document.getElementById('vehicle-fields');
            const residenceFields = document.getElementById('residence-fields');
            
            vehicleFields.style.display = type.includes('vehicule') ? 'block' : 'none';
            residenceFields.style.display = type === 'residence' ? 'block' : 'none';
        }

        function closeModal() {
            document.getElementById('item-modal').classList.remove('active');
            editingItemId = null;
        }

        // ========== FONCTIONS CRUD ==========
        async function saveItem() {
            const type = document.getElementById('item-type').value;
            const titre = document.getElementById('item-title').value.trim();
            const prix = parseInt(document.getElementById('item-price').value);
            const image = document.getElementById('item-image').value.trim();
            const description = document.getElementById('item-description').value.trim();
            
            if (!type || !titre || !prix) {
                showNotification('Veuillez remplir tous les champs obligatoires', 'error');
                return;
            }
            
            let itemData;
            
            if (type.includes('vehicule')) {
                const vehicleType = document.getElementById('vehicle-type').value;
                const status = document.getElementById('vehicle-status').value;
                const features = document.getElementById('vehicle-features').value
                    .split(',')
                    .map(f => f.trim())
                    .filter(f => f);
                
                itemData = {
                    id: editingItemId || Date.now(),
                    titre,
                    categorie: type === 'vehicule_vente' ? 'vente' : 'location',
                    prix,
                    image: image || `https://via.placeholder.com/600x400?text=${encodeURIComponent(titre)}`,
                    description,
                    caracteristiques: features,
                    disponible: status === 'available',
                    type: vehicleType,
                    createdAt: editingItemId ? undefined : new Date().toISOString()
                };
            } else {
                const location = document.getElementById('residence-location').value.trim();
                const rooms = parseInt(document.getElementById('residence-rooms').value);
                const status = document.getElementById('residence-status').value;
                const features = document.getElementById('residence-features').value
                    .split(',')
                    .map(f => f.trim())
                    .filter(f => f);
                
                itemData = {
                    id: editingItemId || Date.now(),
                    titre,
                    categorie: 'location',
                    prix,
                    image: image || `https://via.placeholder.com/600x400?text=${encodeURIComponent(titre)}`,
                    description,
                    caracteristiques: features,
                    disponible: status === 'available',
                    localisation: location,
                    rooms: rooms || 1,
                    createdAt: editingItemId ? undefined : new Date().toISOString()
                };
            }
            
            try {
                await saveItemToDatabase(itemData, editingItemId, type.includes('vehicule') ? 'vehicule' : 'residence');
                closeModal();
                showNotification(
                    editingItemId ? 'Article modifi√© avec succ√®s' : 'Article ajout√© avec succ√®s',
                    'success'
                );
            } catch (error) {
                showNotification('Erreur lors de la sauvegarde', 'error');
            }
        }

        function deleteItem(id, type) {
            pendingAction = { type: 'delete', id, itemType: type };
            document.getElementById('confirm-message').textContent = 
                '√ätes-vous s√ªr de vouloir supprimer cet √©l√©ment ? Cette action est irr√©versible.';
            document.getElementById('confirm-modal').classList.add('active');
        }

        function deleteReservation(id) {
            pendingAction = { type: 'deleteReservation', id };
            document.getElementById('confirm-message').textContent = 
                '√ätes-vous s√ªr de vouloir supprimer cette r√©servation ?';
            document.getElementById('confirm-modal').classList.add('active');
        }

        function closeConfirmModal() {
            document.getElementById('confirm-modal').classList.remove('active');
            pendingAction = null;
        }

        function confirmAction() {
            if (!pendingAction) return;
            
            if (pendingAction.type === 'delete') {
                deleteItemFromDatabase(pendingAction.id, pendingAction.itemType);
            } else if (pendingAction.type === 'deleteReservation') {
                deleteReservationFromDatabase(pendingAction.id);
            }
            
            closeConfirmModal();
        }

        // Mettre √† jour les statuts
        function updateVehicleStatus(id, status) {
            const vehicle = (currentData.vehicules || []).find(v => v.id === id);
            if (!vehicle) return;
            
            vehicle.disponible = status === 'available';
            
            if (status === 'sold') {
                vehicle.categorie = 'vente';
                vehicle.disponible = false;
            } else if (status === 'rented') {
                vehicle.categorie = 'location';
                vehicle.disponible = false;
            }
            
            saveItemToDatabase(vehicle, id, 'vehicule');
        }

        function updateResidenceStatus(id, status) {
            const residence = (currentData.residences || []).find(r => r.id === id);
            if (!residence) return;
            
            residence.disponible = status === 'available';
            saveItemToDatabase(residence, id, 'residence');
        }

        function updateReservationStatus(id, status) {
            const reservation = (currentData.reservations || []).find(r => r.id === id);
            if (!reservation) return;
            
            reservation.statut = status;
            saveToDatabase();
        }

        // Sauvegarder les param√®tres
        function saveSettings() {
            currentData.settings = {
                name: document.getElementById('setting-name').value.trim(),
                description: document.getElementById('setting-description').value.trim(),
                contactPhone: document.getElementById('setting-phone').value.trim(),
                otherPhones: [
                    document.getElementById('setting-phone2').value.trim(),
                    document.getElementById('setting-phone3').value.trim()
                ].filter(p => p),
                contactEmail: document.getElementById('setting-email').value.trim(),
                businessHours: {
                    weekday: document.getElementById('setting-hours-week').value.trim(),
                    saturday: document.getElementById('setting-hours-sat').value.trim(),
                    sunday: document.getElementById('setting-hours-sun').value.trim()
                }
            };
            
            saveToDatabase();
            showNotification('Param√®tres enregistr√©s avec succ√®s', 'success');
        }

        // ========== GESTION DE LA BASE DE DONN√âES ==========
        async function saveItemToDatabase(itemData, itemId = null, itemType = 'vehicule') {
            if (!currentData) return;
            
            if (itemId) {
                // Modification
                const collection = itemType === 'vehicule' ? 'vehicules' : 'residences';
                const index = (currentData[collection] || []).findIndex(item => item.id === itemId);
                if (index !== -1) {
                    currentData[collection][index] = { ...currentData[collection][index], ...itemData };
                }
            } else {
                // Ajout
                const collection = itemType === 'vehicule' ? 'vehicules' : 'residences';
                if (!currentData[collection]) currentData[collection] = [];
                currentData[collection].push(itemData);
            }
            
            await saveToDatabase();
        }

        async function deleteItemFromDatabase(itemId, itemType) {
            if (!currentData) return;
            
            const collection = itemType === 'vehicule' ? 'vehicules' : 'residences';
            const index = (currentData[collection] || []).findIndex(item => item.id === itemId);
            if (index !== -1) {
                currentData[collection].splice(index, 1);
                await saveToDatabase();
                showNotification(`${itemType === 'vehicule' ? 'V√©hicule' : 'R√©sidence'} supprim√©(e) avec succ√®s`, 'success');
                return;
            }
            
            showNotification('√âl√©ment non trouv√©', 'error');
        }

        async function deleteReservationFromDatabase(reservationId) {
            if (!currentData.reservations) return;
            
            const index = (currentData.reservations || []).findIndex(r => r.id === reservationId);
            if (index !== -1) {
                currentData.reservations.splice(index, 1);
                await saveToDatabase();
                showNotification('R√©servation supprim√©e avec succ√®s', 'success');
            }
        }

        async function saveToDatabase() {
            try {
                currentData.meta.last_updated = new Date().toISOString();
                saveDatabase();
                
                // Mettre √† jour l'affichage
                updateDashboard();
                updateAllTables();
                
            } catch (error) {
                console.error('Erreur de sauvegarde:', error);
                showNotification('Erreur de sauvegarde', 'error');
            }
        }

        // ========== FONCTIONS DE SYNCHRONISATION ==========
        async function syncData() {
            try {
                showNotification('Synchronisation en cours...', 'info');
                await loadData();
                showNotification('Synchronisation termin√©e', 'success');
            } catch (error) {
                showNotification('Erreur de synchronisation', 'error');
            }
        }

        function exportData() {
            const dataStr = JSON.stringify(currentData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `grace-auto-database-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Base de donn√©es export√©e avec succ√®s', 'success');
        }

        function showBackupModal() {
            showNotification('Fonctionnalit√© de sauvegarde √† impl√©menter', 'info');
        }

        // D√©connexion
        function logout() {
            if (confirm('√ätes-vous s√ªr de vouloir vous d√©connecter ?')) {
                window.location.href = 'index.html';
            }
        }

        // Filtres
        function filterItems(search) {
            const rows = document.querySelectorAll('#recent-items tr');
            search = search.toLowerCase();
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function filterVehicles(search) {
            const rows = document.querySelectorAll('#vehicles-table tr');
            search = search.toLowerCase();
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        function filterResidences(search) {
            const rows = document.querySelectorAll('#residences-table tr');
            search = search.toLowerCase();
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) ? '' : 'none';
            });
        }

        // ========== √âV√âNEMENTS ==========
        document.addEventListener('DOMContentLoaded', function() {
            // Initialisation
            initDatabase();
            
            // Navigation
            document.querySelectorAll('.admin-menu a').forEach(link => {
                if (link.getAttribute('onclick') && link.getAttribute('onclick').includes('showTab')) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        const tabName = this.getAttribute('onclick').match(/'([^']+)'/)[1];
                        showTab(tabName);
                    });
                }
            });
            
            // Tabs v√©hicules
            document.querySelectorAll('#vehicules .tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('onclick').match(/'([^']+)'/)[1];
                    showVehicleTab(tabName);
                });
            });
            
            console.log('‚úÖ Administration GR√ÇCE AUTO SERVICE charg√©e avec succ√®s');
        });

        // Exposer les fonctions globalement
        window.showTab = showTab;
        window.showVehicleTab = showVehicleTab;
        window.showAddModal = showAddModal;
        window.closeModal = closeModal;
        window.editItem = editItem;
        window.toggleItemFields = toggleItemFields;
        window.saveItem = saveItem;
        window.deleteItem = deleteItem;
        window.deleteReservation = deleteReservation;
        window.closeConfirmModal = closeConfirmModal;
        window.confirmAction = confirmAction;
        window.updateVehicleStatus = updateVehicleStatus;
        window.updateResidenceStatus = updateResidenceStatus;
        window.updateReservationStatus = updateReservationStatus;
        window.saveSettings = saveSettings;
        window.syncData = syncData;
        window.exportData = exportData;
        window.showBackupModal = showBackupModal;
        window.logout = logout;
        window.filterItems = filterItems;
        window.filterVehicles = filterVehicles;
        window.filterResidences = filterResidences;
    </script>
</body>
</html>
